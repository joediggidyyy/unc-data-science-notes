{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://codesentinel.dev/schemas/data_manifest.schema.json",
  "title": "CodeSentinel Data Manifest",
  "description": "Canonical metadata schema for CodeSentinel datasets, reports, logs, and documentation artifacts.",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "dataset_id",
    "domain",
    "workflow",
    "keywords",
    "source_path",
    "retention_window",
    "archive_path",
    "backlinks"
  ],
  "properties": {
    "dataset_id": {
      "type": "string",
      "pattern": "^[a-z0-9_.\\-]+$",
      "description": "Stable identifier for the dataset (kebab, snake, or dotted name)."
    },
    "domain": {
      "type": "string",
      "description": "Primary business or technical domain (e.g., metrics, automation, security)."
    },
    "workflow": {
      "type": "string",
      "description": "Named workflow, pipeline, or protocol that produced this dataset."
    },
    "keywords": {
      "type": "array",
      "description": "Searchable tags to speed discovery.",
      "minItems": 1,
      "items": {
        "type": "string"
      },
      "uniqueItems": true
    },
    "source_path": {
      "type": "string",
      "description": "Repository-relative path pointing to the authoritative copy (ASCII-safe)."
    },
    "retention_window": {
      "type": "object",
      "description": "Time-bound rules governing how long the dataset remains in its active location.",
      "additionalProperties": false,
      "required": [
        "active_days",
        "notes"
      ],
      "properties": {
        "active_days": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of days the dataset must remain accessible before archival."
        },
        "notes": {
          "type": "string",
          "description": "Free-form rationale or instructions for the retention window."
        }
      }
    },
    "archive_path": {
      "type": "string",
      "description": "Destination path (repository-relative) where the dataset is moved after active retention expires."
    },
    "backlinks": {
      "type": "array",
      "description": "Reverse pointers to related manifests, documentation, or ORACL entries (bi-directional links).",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": [
          "type",
          "target",
          "relation"
        ],
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "manifest",
              "document",
              "oracl_tier",
              "external"
            ],
            "description": "Kind of asset being referenced."
          },
          "target": {
            "type": "string",
            "description": "Identifier or path of the linked asset."
          },
          "relation": {
            "type": "string",
            "description": "Human-readable relationship description (e.g., promotes, cites, derives-from)."
          }
        }
      }
    },
    "metadata": {
      "type": "object",
      "description": "Optional extensibility bucket for future attributes (ingestion timestamps, signers, etc.)."
    }
  }
}
